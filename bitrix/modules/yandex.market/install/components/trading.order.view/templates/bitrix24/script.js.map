{"version":3,"file":"script.js","sources":["src/factory.js","src/utils.js","src/reference/field.js","src/basket/summaryskeleton.js","src/basket/cis.js","src/basket/digital.js","src/bracketchain.js","src/basket/itemview.js","src/basket/itemedit.js","src/basket/field.js","src/basketconfirm/field.js","src/box/itemview.js","src/box/itemedit.js","src/box/collection.js","src/shipment/field.js","src/property/field.js","src/print/field.js","src/notification/field.js","src/index.js","src/compatible/editor.js"],"sourcesContent":["const BX = window.BX;\r\n\r\nexport default class Factory {\r\n\r\n\tstatic defaults = {\r\n\t\tname: 'yamarket',\r\n\t\tmap: {},\r\n\t}\r\n\r\n\tconstructor(options = {}) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\tregister() {\r\n\t\tif (this.isEditorInitialized()) {\r\n\t\t\tthis.registerEditorMethod();\r\n\t\t} else {\r\n\t\t\tthis.handleEditorInit(true);\r\n\t\t}\r\n\t}\r\n\r\n\tisEditorInitialized() {\r\n\t\treturn BX.UI?.EntityEditorControlFactory?.initialized;\r\n\t}\r\n\r\n\tregisterEditorMethod() {\r\n\t\tBX.UI.EntityEditorControlFactory.registerFactoryMethod(this.options.name, this.build);\r\n\t}\r\n\r\n\thandleEditorInit(dir) {\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](window, 'BX.UI.EntityEditorControlFactory:onInitialize', this.onEditorInit);\r\n\t}\r\n\r\n\tonEditorInit = (factory, event) => {\r\n\t\tevent.methods[this.options.name] = this.build;\r\n\t\tthis.handleEditorInit(false);\r\n\t}\r\n\r\n\tbuild = (type, controlId, settings) => {\r\n\t\tconst prefix = this.options.name + '_';\r\n\r\n\t\tif (type.indexOf(prefix) !== 0) { return null; }\r\n\r\n\t\tconst internalType = type.substr(prefix.length);\r\n\r\n\t\tif (!this.options.map.hasOwnProperty(internalType)) { return null; }\r\n\r\n\t\tconst fieldClass = this.options.map[internalType];\r\n\r\n\t\treturn fieldClass.create(controlId, settings);\r\n\t}\r\n}","export function htmlToElement(html, tag = 'div') {\r\n\tconst renderer = document.createElement(tag);\r\n\r\n\trenderer.innerHTML = html;\r\n\r\n\treturn renderer.firstElementChild;\r\n}\r\n\r\nexport function pascalCase(str) {\r\n\treturn str\r\n\t\t.split('_')\r\n\t\t.map((word) => word.substr(0, 1).toUpperCase() + word.substr(1).toLowerCase())\r\n\t\t.join('');\r\n}\r\n\r\nexport function camelCase(str) {\r\n\treturn str\r\n\t\t.split('_')\r\n\t\t.map((word, index) => index === 0 ? word.toLowerCase() : word.substr(0, 1).toUpperCase() + word.substr(1).toLowerCase())\r\n\t\t.join('');\r\n}\r\n\r\nexport function kebabCase(str) {\r\n\treturn str\r\n\t\t.split('_')\r\n\t\t.map((word, index) =>  word.toLowerCase())\r\n\t\t.join('-');\r\n}\r\n\r\nexport function copyValues(from, to) {\r\n\tconst fromValues = collectValues(from);\r\n\r\n\treturn fillValues(to, fromValues);\r\n}\r\n\r\nexport function collectValues(container) {\r\n\tconst inputs = findInputs(container);\r\n\tconst result = {};\r\n\r\n\tfor (const [name, input] of Object.entries(inputs)) {\r\n\t\tresult[name] = input.value;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function fillValues(container, values) {\r\n\tconst inputs = findInputs(container);\r\n\tlet isChanged = false;\r\n\r\n\tfor (const [name, value] of Object.entries(values)) {\r\n\t\tif (inputs[name] == null) { continue; }\r\n\r\n\t\tconst input = inputs[name];\r\n\r\n\t\tif (input.value === value) { continue; }\r\n\r\n\t\tisChanged = true;\r\n\t\tinput.value = value;\r\n\t}\r\n\r\n\treturn isChanged;\r\n}\r\n\r\nexport function findInputs(container) {\r\n\tconst inputs = container.querySelectorAll('input, select, textarea');\r\n\tconst result = {};\r\n\r\n\tfor (const input of inputs) {\r\n\t\tif (!input.name) { continue; }\r\n\r\n\t\tresult[input.name] = input;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function replaceTemplateVariables(template, variables) {\r\n\tlet result = template;\r\n\r\n\tif (variables == null) { return result; }\r\n\r\n\tfor (const [key, value] of Object.entries(variables)) {\r\n\t\tresult = result.replace('#' + key + '#', value);\r\n\t}\r\n\r\n\treturn result;\r\n}","import {replaceTemplateVariables} from \"../utils\";\r\n\r\nexport default class Field extends BX.UI.EntityEditorField {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._hasLayout = false;\r\n\t\tthis.options = this.constructor.defaults != null\r\n\t\t\t? Object.assign({}, this.constructor.defaults)\r\n\t\t\t: {};\r\n\t}\r\n\r\n\tgetMessage(key, replaces = null) {\r\n\t\tlet result = this.constructor.messages[key] || super.getMessage(key);\r\n\r\n\t\tif (replaces != null) {\r\n\t\t\tresult = replaceTemplateVariables(result, replaces);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tclearLayout() {\r\n\t\tif (!this._hasLayout) { return; }\r\n\r\n\t\tthis.forget();\r\n\r\n\t\tthis._wrapper.innerHTML = '';\r\n\t\tthis._hasLayout = false;\r\n\t}\r\n\r\n\tlayout(options) {\r\n\t\tif (this._hasLayout) { return; }\r\n\r\n\t\tthis.ensureWrapperCreated({});\r\n\t\tthis.adjustWrapper();\r\n\r\n\t\tif (!this.isNeedToDisplay()) {\r\n\t\t\tthis.registerLayout(options);\r\n\t\t\tthis._hasLayout = true;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.forget();\r\n\r\n\t\tthis._wrapper.innerHTML = '';\r\n\r\n\t\tif (this.isDragEnabled()) {\r\n\t\t\tthis._wrapper.appendChild(this.createDragButton());\r\n\t\t}\r\n\r\n\t\tif (this.useTitle()) {\r\n\t\t\tconst title = this.getTitle();\r\n\t\t\tthis._wrapper.appendChild(this.createTitleNode(title));\r\n\t\t}\r\n\r\n\t\tthis.render(this.getValue());\r\n\r\n\t\tif (this.isContextMenuEnabled()) {\r\n\t\t\tthis._wrapper.appendChild(this.createContextMenuButton());\r\n\t\t}\r\n\r\n\t\tif (this.isDragEnabled()) {\r\n\t\t\tthis.initializeDragDropAbilities();\r\n\t\t}\r\n\r\n\t\tthis.registerLayout(options);\r\n\t\tthis._hasLayout = true;\r\n\t}\r\n\r\n\tforget() {}\r\n\r\n\trender(payload) {}\r\n\r\n\tuseTitle() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfewElements(key) {\r\n\t\tconst selector = this.getElementSelector(key);\r\n\t\tlet result;\r\n\r\n\t\tif (selector.indexOf('#') === 0) {\r\n\t\t\tresult = document.querySelectorAll(selector);\r\n\t\t} else {\r\n\t\t\tresult = this.el.querySelectorAll(selector);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetElement(key) {\r\n\t\tconst selector = this.getElementSelector(key);\r\n\t\tlet result;\r\n\r\n\t\tif (selector.indexOf('#') === 0) {\r\n\t\t\tresult = document.querySelector(selector);\r\n\t\t} else {\r\n\t\t\tresult = this.el.querySelector(selector);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetElementSelector(key) {\r\n\t\treturn this.options[key + 'Element'];\r\n\t}\r\n}","import {copyValues, replaceTemplateVariables} from \"../utils\";\r\nimport './summary.css';\r\n\r\nexport default class SummarySkeleton {\r\n\r\n\tstatic STATUS_READY = 'READY';\r\n\tstatic STATUS_WAIT = 'WAIT';\r\n\tstatic STATUS_EMPTY = 'EMPTY';\r\n\r\n\tstatic defaults = {\r\n\t\tmodalElement: '.yamarket-item-summary__modal',\r\n\t\tstatusElement: '.yamarket-item-summary__status',\r\n\t\tinputElement: 'input',\r\n\r\n\t\tname: null,\r\n\t\tmessages: {},\r\n\t\tonChange: null,\r\n\t};\r\n\r\n\tconstructor(options) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t\tthis.el = null;\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.handleStatusClick(true);\r\n\t}\r\n\r\n\thandleStatusClick(dir) {\r\n\t\tconst status = this.getElement('status');\r\n\r\n\t\tstatus[dir ? 'addEventListener' : 'removeEventListener']('click', this.onStatusClick);\r\n\t}\r\n\r\n\tonStatusClick = (evt) => {\r\n\t\tthis.openDialog();\r\n\t\tevt.preventDefault();\r\n\t}\r\n\r\n\tsetup(element) {\r\n\t\tthis.el = element;\r\n\t\tthis.bind();\r\n\t}\r\n\r\n\tbuild() {\r\n\t\treturn `<div class=\"yamarket-item-summary\">\r\n\t\t\t${this.buildStatus()}\r\n\t\t\t<div class=\"yamarket-item-summary__modal\" hidden>\r\n\t\t\t\t${this.buildForm()}\r\n\t\t\t</div>\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildStatus() {\r\n\t\tconst cises = this.optionValue();\r\n\t\tconst status = this.getStatus(cises);\r\n\r\n\t\treturn `<a class=\"yamarket-item-summary__status\" href=\"#\" data-status=\"${status}\">${this.getMessage('SUMMARY_' + status)}</a>`\r\n\t}\r\n\r\n\treflowStatus() {\r\n\t\tconst value = this.formValue();\r\n\t\tconst status = this.getStatus(value);\r\n\t\tconst element = this.getElement('status');\r\n\r\n\t\telement.setAttribute('data-status', status);\r\n\t\telement.textContent = this.getMessage('SUMMARY_' + status);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {any} value\r\n\t *\r\n\t * @return {string}\r\n\t */\r\n\tgetStatus(value) {\r\n\t\tthrow new Error('not implemented');\r\n\t}\r\n\r\n\t/** @return {string} */\r\n\tbuildForm(useFormValue = false) {\r\n\t\tthrow new Error('not implemented');\r\n\t}\r\n\r\n\treflowForm() {\r\n\t\tconst modal = this.el.querySelector('.yamarket-item-summary__modal');\r\n\r\n\t\tmodal.innerHTML = this.buildForm(true);\r\n\t}\r\n\r\n\t/** @return {any} */\r\n\toptionValue() {\r\n\t\tthrow new Error('not implemented');\r\n\t}\r\n\r\n\t/** @return {any} */\r\n\tformValue() {\r\n\t\tthrow new Error('not implemented');\r\n\t}\r\n\r\n\topenDialog() {\r\n\t\tconst modal = this.getElement('modal').firstElementChild;\r\n\t\tconst messageBox = BX.UI.Dialogs.MessageBox.create({\r\n\t\t\ttitle: this.getMessage('MODAL_TITLE'),\r\n\t\t});\r\n\r\n\t\tmessageBox.setMessage(modal.cloneNode(true));\r\n\t\tmessageBox.setButtons([\r\n\t\t\tnew BX.UI.SaveButton({\r\n\t\t\t\tevents: {\r\n\t\t\t\t\tclick: this.onSaveClick.bind(this, messageBox),\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tnew BX.UI.CancelButton({\r\n\t\t\t\tevents: {\r\n\t\t\t\t\tclick: this.onCancelClick.bind(this, messageBox),\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t]);\r\n\r\n\t\tmessageBox.show();\r\n\t}\r\n\r\n\tonSaveClick(messageBox) {\r\n\t\tconst isChanged = copyValues(messageBox.popupWindow.contentContainer, this.el);\r\n\r\n\t\tif (isChanged && this.options.onChange) {\r\n\t\t\tthis.options.onChange();\r\n\t\t}\r\n\r\n\t\tthis.reflowStatus();\r\n\r\n\t\tmessageBox.close();\r\n\t}\r\n\r\n\tonCancelClick(messageBox) {\r\n\t\tmessageBox.close();\r\n\t}\r\n\r\n\tgetMessage(key, replaces = null) {\r\n\t\tlet result = this.options.messages[key] || key;\r\n\r\n\t\tif (replaces != null) {\r\n\t\t\tresult = replaceTemplateVariables(result, replaces);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfewElements(key) {\r\n\t\tconst selector = this.getElementSelector(key);\r\n\r\n\t\treturn this.el.querySelectorAll(selector);\r\n\t}\r\n\r\n\tgetElement(key) {\r\n\t\tconst selector = this.getElementSelector(key);\r\n\r\n\t\treturn this.el.querySelector(selector);\r\n\t}\r\n\r\n\tgetElementSelector(key) {\r\n\t\treturn this.options[key + 'Element'];\r\n\t}\r\n\r\n}","import SummarySkeleton from \"./summaryskeleton\";\r\nimport {fillValues, replaceTemplateVariables} from \"../utils\";\r\n\r\nexport default class Cis extends SummarySkeleton {\r\n\r\n\tstatic defaults = Object.assign({}, SummarySkeleton.defaults, {\r\n\t\tcopyElement: null,\r\n\r\n\t\ttotal: 0,\r\n\t\trequired: false,\r\n\t\tinstances: [],\r\n\t\tinternalInstances: [],\r\n\t})\r\n\r\n\tbind() {\r\n\t\tsuper.bind();\r\n\t\tthis.handleCopyClick(true);\r\n\t}\r\n\r\n\thandleCopyClick(dir) {\r\n\t\tconst copy = this.getElement('copy');\r\n\r\n\t\tif (copy == null) { return; }\r\n\r\n\t\tcopy[dir ? 'addEventListener' : 'removeEventListener']('click', this.onCopyClick);\r\n\t}\r\n\r\n\tonCopyClick = (evt) => {\r\n\t\tthis.copyInternal();\r\n\t\tevt.preventDefault();\r\n\t}\r\n\r\n\tupdateTotal(count) {\r\n\t\tthis.options.total = count;\r\n\t\tthis.reflowStatus();\r\n\t\tthis.reflowForm();\r\n\t}\r\n\r\n\tbuild() {\r\n\t\tconst internalCises = this.optionValue('internal');\r\n\r\n\t\treturn `<div class=\"yamarket-item-summary\">\r\n\t\t\t${this.buildStatus()}\r\n\t\t\t${internalCises.length > 0 ? this.buildCopyIcon() : ''}\r\n\t\t\t<div class=\"yamarket-item-summary__modal\" hidden>\r\n\t\t\t\t${this.buildForm()}\r\n\t\t\t</div>\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildCopyIcon() {\r\n\t\treturn `<button class=\"yamarket-item-summary__copy\" type=\"button\" title=\"${this.getMessage('COPY')}\">\r\n\t\t\t${this.getMessage('COPY')}\r\n\t\t</button>`;\r\n\t}\r\n\r\n\tbuildForm(useFormValue = false) {\r\n\t\tconst total = parseInt(this.options.total) || 0;\r\n\t\tconst iterator = (new Array(total)).fill(null);\r\n\t\tconst value = useFormValue ? this.formValue() : this.optionValue();\r\n\r\n\t\treturn `<div class=\"ui-form\">\r\n\t\t\t${iterator.map((dummy, index) => {\r\n\t\t\t\tconst one = value[index] || '';\r\n\t\t\t\t\r\n\t\t\t\treturn `<div class=\"ui-form-row-inline\">\r\n\t\t\t\t\t<div class=\"ui-form-row-inline-col\">\r\n\t\t\t\t\t\t<div class=\"ui-form-label\">\r\n\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">&numero;${index + 1}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"ui-form-content\">\r\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-sm ui-ctl-textbox ui-ctl-w100\">\r\n\t\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" name=\"${this.options.name}[${index}]\" value=\"${BX.util.htmlspecialchars(one)}\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>`;\r\n\t\t\t}).join('')}\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tgetStatus(value) {\r\n\t\tlet result;\r\n\r\n\t\tif (value.length >= this.options.total) {\r\n\t\t\tresult = SummarySkeleton.STATUS_READY;\r\n\t\t} else if (value.length > 0 || this.options.required) {\r\n\t\t\tresult = SummarySkeleton.STATUS_WAIT;\r\n\t\t} else {\r\n\t\t\tresult = SummarySkeleton.STATUS_EMPTY;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tcopyInternal(container = this.el) {\r\n\t\tconst isChanged = fillValues(container, this.makeInternalValues());\r\n\r\n\t\tif (!isChanged) { return; }\r\n\r\n\t\tthis.options.onChange && this.options.onChange();\r\n\t\tthis.reflowStatus();\r\n\t}\r\n\r\n\tmakeInternalValues() {\r\n\t\tconst cises = this.optionValue('internal');\r\n\t\tconst result = {};\r\n\r\n\t\tfor (let index = 0; index < cises.length; ++index) {\r\n\t\t\tresult[`${this.options.name}[${index}]`] = cises[index];\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tformValue() {\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const input of this.fewElements('input')) {\r\n\t\t\tconst value = input.value.trim();\r\n\r\n\t\t\tif (value === '') { continue; }\r\n\r\n\t\t\tresult.push(value);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\toptionValue(optionKey = null) {\r\n\t\tconst instances = optionKey != null ? this.options[optionKey + 'Instances'] : this.options.instances;\r\n\r\n\t\treturn instances.map((instance) => instance['CIS']).filter((cis) => cis != null && cis.length > 0);\r\n\t}\r\n\r\n\tgetMessage(key, replaces = null) {\r\n\t\tconst keyWithPrefix = 'ITEM_CIS_' + key;\r\n\t\tconst option = this.options.messages[keyWithPrefix];\r\n\r\n\t\tif (option != null) {\r\n\t\t\treturn replaceTemplateVariables(option, replaces);\r\n\t\t}\r\n\r\n\t\treturn super.getMessage(key, replaces);\r\n\t}\r\n\r\n}","import SummarySkeleton from \"./summaryskeleton\";\r\nimport {collectValues, replaceTemplateVariables} from \"../utils\";\r\nimport {BracketChain} from \"../bracketchain\";\r\n\r\nexport default class Digital extends SummarySkeleton {\r\n\r\n\tstatic defaults = Object.assign({}, SummarySkeleton.defaults, {\r\n\t\titems: [],\r\n\t\ttotal: 0,\r\n\t})\r\n\r\n\tupdateTotal(count) {\r\n\t\tthis.options.total = count;\r\n\t\tthis.reflowStatus();\r\n\t\tthis.reflowForm();\r\n\t}\r\n\r\n\tbuildForm(useFormValue = false) {\r\n\t\tconst total = parseInt(this.options.total) || 0;\r\n\t\tconst formValue = useFormValue ? this.formValue() : this.optionValue();\r\n\r\n\t\treturn `<div class=\"ui-form\">\r\n\t\t\t${this.buildFormCodes(total, formValue)}\r\n\t\t\t${this.buildFormAdditional(total, formValue)}\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildFormCodes(total, formValue) {\r\n\t\tconst hasFew = (total > 1);\r\n\t\tconst iterator = (new Array(total)).fill(null);\r\n\r\n\t\treturn iterator.map((dummy, index) => {\r\n\t\t\tconst oneValue = formValue?.ITEM?.[index] || {};\r\n\r\n\t\t\tlet title = '';\r\n\t\t\tlet fieldset = `<div class=\"ui-form-row\">\r\n\t\t\t\t<div class=\"ui-form-label\">\r\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${this.getMessage('CODE')}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"ui-form-content\">\r\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\r\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" name=\"${this.options.name}[ITEM][${index}][CODE]\" value=\"${BX.util.htmlspecialchars(oneValue['CODE'] || '')}\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"ui-form-row\">\r\n\t\t\t\t<div class=\"ui-form-label\">\r\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${this.getMessage('ACTIVATE_TILL')}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"ui-form-content\">\r\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-datetime ui-ctl-w100\">\r\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-calendar\"></div>\r\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" name=\"${this.options.name}[ITEM][${index}][ACTIVATE_TILL]\" value=\"${BX.util.htmlspecialchars(oneValue['ACTIVATE_TILL'] || '')}\" onclick=\"BX.calendar({node: this, field: this, bTime: false, bHideTime: true})\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>`;\r\n\r\n\t\t\tif (hasFew) {\r\n\t\t\t\ttitle = `<div class=\"yamarket-form-group-title\">${this.getMessage('GROUP', { 'NUMBER': index + 1 })}</div>`;\r\n\t\t\t}\r\n\r\n\t\t\treturn title + fieldset;\r\n\t\t}).join('');\r\n\t}\r\n\r\n\tbuildFormAdditional(total, formValue) {\r\n\t\tconst hasFew = (total > 1);\r\n\t\tlet title = '';\r\n\t\tlet fieldset = `<div class=\"ui-form-row\">\r\n\t\t\t<div class=\"ui-form-label\">\r\n\t\t\t\t<div class=\"ui-ctl-label-text\">${this.getMessage('SLIP')}</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"ui-form-content\">\r\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\r\n\t\t\t\t\t<textarea class=\"ui-entity-editor-field-textarea\" name=\"${this.options.name}[SLIP]\" rows=\"5\" required>${BX.util.htmlspecialchars(formValue['SLIP'] || '')}</textarea>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>`;\r\n\r\n\t\tif (hasFew) {\r\n\t\t\ttitle = `<div class=\"yamarket-form-group-title\">${this.getMessage('ADDITIONAL')}</div>`;\r\n\t\t}\r\n\r\n\t\treturn title + fieldset;\r\n\t}\r\n\r\n\tgetStatus(value) {\r\n\t\tconst filledItems = this.filterFilledItems(value.ITEM);\r\n\t\tconst isItemsFilled = filledItems.length >= this.options.total;\r\n\t\tconst isSlipFilled = (value['SLIP'] != null && value['SLIP'].trim() !== '');\r\n\r\n\t\treturn (\r\n\t\t\tisItemsFilled && isSlipFilled\r\n\t\t\t\t? SummarySkeleton.STATUS_READY\r\n\t\t\t\t: SummarySkeleton.STATUS_WAIT\r\n\t\t);\r\n\t}\r\n\r\n\tfilterFilledItems(items) {\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const item of items) {\r\n\t\t\tif (item['CODE'] == null || item['CODE'].trim() === '') { continue; }\r\n\t\t\tif (item['ACTIVATE_TILL'] == null || item['ACTIVATE_TILL'].trim() === '') { continue; }\r\n\r\n\t\t\tresult.push(item);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\toptionValue() {\r\n\t\tconst items = Array.isArray(this.options.items) ? this.options.items : [];\r\n\t\tlet slip = '';\r\n\r\n\t\tfor (const item of items) {\r\n\t\t\tif (item['SLIP'] != null && item['SLIP'] !== '') {\r\n\t\t\t\tslip = item['SLIP'];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\t'ITEM': items,\r\n\t\t\t'SLIP': slip,\r\n\t\t};\r\n\t}\r\n\r\n\tformValue() {\r\n\t\tconst rawValues = collectValues(this.el);\r\n\t\tconst values = BracketChain.toTree(rawValues, this.options.name);\r\n\t\tconst defaults = {\r\n\t\t\t'ITEM': [],\r\n\t\t\t'SLIP': '',\r\n\t\t};\r\n\r\n\t\treturn Object.assign(defaults, values);\r\n\t}\r\n\r\n\tgetMessage(key, replaces = null) {\r\n\t\tconst keyWithPrefix = 'ITEM_DIGITAL_' + key;\r\n\t\tconst option = this.options.messages[keyWithPrefix];\r\n\r\n\t\tif (option != null) {\r\n\t\t\treturn replaceTemplateVariables(option, replaces);\r\n\t\t}\r\n\r\n\t\treturn super.getMessage(key, replaces);\r\n\t}\r\n}","export class BracketChain {\r\n\r\n\tstatic toTree(values, base = null) {\r\n\t\tconst result = {};\r\n\r\n\t\tfor (const key in values) {\r\n\t\t\tif (!values.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\tconst keyRelative = this.keyRelative(key, base);\r\n\r\n\t\t\tif (keyRelative == null) { continue; }\r\n\r\n\t\t\tconst keyChain = this.valueKeyChain(keyRelative);\r\n\r\n\t\t\tthis.setValueByKeyChain(result, keyChain, values[key]);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic keyRelative(key, base) {\r\n\t\tif (base == null) { return key; }\r\n\t\tif (key.indexOf(base) !== 0) { return null; }\r\n\r\n\t\treturn key.replace(base, '');\r\n\t}\r\n\r\n\tstatic valueKeyChain(key) {\r\n\t\tconst parts = key.split('[');\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const part of parts) {\r\n\t\t\tif (part === '' && result.length === 0) { continue; }\r\n\r\n\t\t\tconst name = part.replace(/]$/, '');\r\n\r\n\t\t\tresult.push(name);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic setValueByKeyChain(result, chain, value) {\r\n\t\tconst lastKey = chain.pop();\r\n\t\tlet level = result;\r\n\r\n\t\tfor (let index = 0; index < chain.length; ++index) {\r\n\t\t\tconst key = chain[index];\r\n\t\t\tconst nextKey = (index + 1 === chain.length) ? lastKey : chain[index + 1];\r\n\r\n\t\t\tif (level[key] == null) {\r\n\t\t\t\tlevel[key] = /^\\d+$/.test(nextKey) ? [] : {};\r\n\t\t\t}\r\n\r\n\t\t\tlevel = level[key];\r\n\t\t}\r\n\r\n\t\tlevel[lastKey] = value;\r\n\t}\r\n\r\n}","import Cis from \"./cis\";\r\nimport Digital from \"./digital\";\r\nimport { htmlToElement, pascalCase, kebabCase } from \"../utils\";\r\n\r\nexport default class ItemView {\r\n\tstatic defaults = {\r\n\t\tmessages: {},\r\n\t\tname: null,\r\n\t\ttitle: null,\r\n\t\tactions: [],\r\n\t\tonChange: null,\r\n\t}\r\n\r\n\tconstructor(options) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t\tthis._wires = [];\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis.forgetWires();\r\n\t\tthis.options = {};\r\n\t}\r\n\r\n\tgetMessage(key) {\r\n\t\treturn this.options.messages[key] || key;\r\n\t}\r\n\r\n\tgetTitle() {\r\n\t\treturn this.options.title;\r\n\t}\r\n\r\n\textendOptions(item) {\r\n\t\tthis.options = Object.assign(this.options, {\r\n\t\t\ttitle: item['NAME'],\r\n\t\t});\r\n\t}\r\n\r\n\trender(item, basket) {\r\n\t\tconst columns = Object.keys(basket.COLUMNS);\r\n\r\n\t\tcolumns.unshift('INDEX');\r\n\r\n\t\tthis.forgetWires();\r\n\t\tthis.extendOptions(item);\r\n\r\n\t\tthis.el = htmlToElement(`<tr>\r\n\t\t\t${columns.map((key) => this.renderColumn(item, key)).join('')}\r\n\t\t\t${this.renderActions()}\r\n\t\t</tr>`, 'tbody');\r\n\r\n\t\tthis.setupWires();\r\n\t}\r\n\r\n\tmount(point) {\r\n\t\tpoint.appendChild(this.el);\r\n\t}\r\n\r\n\trenderColumn(item, key) {\r\n\t\tconst method = 'column' + pascalCase(key);\r\n\r\n\t\treturn (\r\n\t\t\tmethod in this\r\n\t\t\t\t? this[method](item, key)\r\n\t\t\t\t: this.columnDefault(item, key)\r\n\t\t);\r\n\t}\r\n\r\n\tcolumnIndex(item, key) {\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\">\r\n\t\t\t<input type=\"hidden\" name=\"${this.getName('ID')}\" value=\"${this.value(item, 'ID')}\" />\r\n\t\t\t${this.valueFormatted(item, key)}\r\n\t\t</td>`;\r\n\t}\r\n\r\n\tcolumnCis(item, key) {\r\n\t\tconst cis = new Cis({\r\n\t\t\tmessages: this.options.messages,\r\n\t\t\tname: this.getName('CIS'),\r\n\t\t\trequired: !!this.value(item, 'MARKING_GROUP'),\r\n\t\t\ttotal: this.value(item, 'COUNT'),\r\n\t\t\tinstances: this.value(item, 'INSTANCES'),\r\n\t\t\tinternalInstances: this.value(item, 'INTERNAL_INSTANCES'),\r\n\t\t\tonChange: this.options.onChange,\r\n\t\t});\r\n\r\n\t\tthis.wire(key, cis);\r\n\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\" data-wire=\"${key}\">${cis.build()}</td>`;\r\n\t}\r\n\r\n\tcolumnDigital(item, key) {\r\n\t\tconst digital = new Digital({\r\n\t\t\tmessages: this.options.messages,\r\n\t\t\tname: this.getName('DIGITAL'),\r\n\t\t\ttotal: this.value(item, 'COUNT'),\r\n\t\t\titems: this.value(item, 'DIGITAL'),\r\n\t\t\tonChange: this.options.onChange,\r\n\t\t});\r\n\r\n\t\tthis.wire(key, digital);\r\n\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\" data-wire=\"${key}\">${digital.build()}</td>`;\r\n\t}\r\n\r\n\tcolumnSubsidy(item, key) {\r\n\t\tconst promos = this.value(item, 'PROMOS');\r\n\t\tlet content = this.valueFormatted(item, key);\r\n\r\n\t\tif (promos != null && Array.isArray(promos)) {\r\n\t\t\tcontent += promos.map((promo) => `<div>${promo}</div>`).join('');\r\n\t\t}\r\n\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\">${content}</td>`;\r\n\t}\r\n\r\n\tcolumnCount(item, key) {\r\n\t\tconst value = this.value(item, key);\r\n\t\tconst valueSanitized = parseFloat(value) || '';\r\n\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\">\r\n\t\t\t<input type=\"hidden\" name=\"${this.getName('INITIAL_COUNT')}\" value=\"${valueSanitized}\" />\r\n\t\t\t<input type=\"hidden\" name=\"${this.getName('COUNT')}\" value=\"${valueSanitized}\" />\r\n\t\t\t${this.valueFormatted(item, key)} ${this.getMessage('ITEM_UNIT')}\r\n\t\t</td>`;\r\n\t}\r\n\r\n\tcolumnDefault(item, key) {\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\">${this.valueFormatted(item, key)}</td>`;\r\n\t}\r\n\r\n\trenderActions() {\r\n\t\treturn '';\r\n\t}\r\n\r\n\twire(key, instance) {\r\n\t\tthis._wires[key] = instance;\r\n\t}\r\n\r\n\tforgetWires() {\r\n\t\tthis._wires = {};\r\n\t}\r\n\r\n\tsetupWires() {\r\n\t\tfor (const [key, instance] of Object.entries(this._wires)) {\r\n\t\t\tconst column = this.el.querySelector(`[data-wire=\"${key}\"]`);\r\n\t\t\tconst element = column.firstElementChild;\r\n\r\n\t\t\tif (!element) { continue; }\r\n\r\n\t\t\tinstance.setup(element);\r\n\t\t}\r\n\t}\r\n\r\n\tcallWires(method, args = []) {\r\n\t\tfor (const [, instance] of Object.entries(this._wires)) {\r\n\t\t\tif (typeof instance[method] !== 'function') { return; }\r\n\r\n\t\t\tinstance[method].apply(instance, args);\r\n\t\t}\r\n\t}\r\n\r\n\tvalueFormatted(item, key) {\r\n\t\tconst formattedKey = key + '_FORMATTED';\r\n\t\tlet result = '';\r\n\r\n\t\tif (item[formattedKey] != null) {\r\n\t\t\tresult = item[formattedKey];\r\n\t\t} else if (item[key] != null) {\r\n\t\t\tresult = item[key];\r\n\t\t}\r\n\r\n\t\treturn result !== '' ? result : '&mdash;';\r\n\t}\r\n\r\n\tvalue(item, key) {\r\n\t\treturn item[key];\r\n\t}\r\n\r\n\tgetName(field) {\r\n\t\treturn this.options.name + '[' + field + ']';\r\n\t}\r\n\r\n\thasAction(type) {\r\n\t\treturn this.options.actions.indexOf(type) !== -1;\r\n\t}\r\n}","import ItemView from \"./itemview\";\r\nimport {kebabCase} from \"../utils\";\r\n\r\nexport default class ItemEdit extends ItemView {\r\n\tstatic ACTION_ITEM = 'item';\r\n\tstatic ACTION_CIS = 'cis';\r\n\tstatic ACTION_DIGITAL = 'digital';\r\n\r\n\tstatic defaults = Object.assign({}, ItemView.defaults)\r\n\r\n\tdestroy() {\r\n\t\tthis.unbind();\r\n\t\tsuper.destroy();\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.handleInputChange(false);\r\n\t\tthis.handleDeleteToggle(false);\r\n\t}\r\n\r\n\thandleInputChange(dir) {\r\n\t\tif (!this.options.onChange) { return; }\r\n\r\n\t\tthis.el.querySelectorAll('input').forEach((input) => {\r\n\t\t\tif (input.name === this.getName('COUNT')) {\r\n\t\t\t\tinput[dir ? 'addEventListener' : 'removeEventListener']('change', this.onCountChange);\r\n\t\t\t}\r\n\r\n\t\t\tinput[dir ? 'addEventListener' : 'removeEventListener']('change', this.options.onChange);\r\n\t\t});\r\n\t}\r\n\r\n\thandleDeleteToggle(dir) {\r\n\t\tconst input = this.el.querySelector('.yamarket-delete-toggle__input');\r\n\r\n\t\tif (!this.hasAction(ItemEdit.ACTION_ITEM) || !input) { return; }\r\n\r\n\t\tinput[dir ? 'addEventListener' : 'removeEventListener']('change', this.onDeleteToggle);\r\n\t}\r\n\r\n\tonCountChange = (evt) => {\r\n\t\tconst count = parseInt(evt.target.value);\r\n\r\n\t\tif (isNaN(count)) { return; }\r\n\r\n\t\tthis.callWires('updateTotal', [count]);\r\n\t}\r\n\r\n\tonDeleteToggle = (evt) => {\r\n\t\tconst isDelete = !!evt.target.checked;\r\n\r\n\t\tthis.el.classList.toggle('is--delete', isDelete);\r\n\t\tthis.disableInput(isDelete);\r\n\t}\r\n\r\n\tdisableInput(dir) {\r\n\t\tthis.el.querySelectorAll('input').forEach((input) => {\r\n\t\t\tif (input.name === this.getName('DELETE')) { return; }\r\n\r\n\t\t\tinput.readonly = dir;\r\n\r\n\t\t\tif (input.classList.contains('ui-ctl-element')) {\r\n\t\t\t\tinput.parentElement.classList.toggle('ui-ctl-disabled', dir);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgetCountDiff() {\r\n\t\tconst needDelete = this.getInputValue('DELETE');\r\n\t\tconst initialCount = parseInt(this.getInputValue('INITIAL_COUNT'));\r\n\t\tconst count = parseInt(this.getInputValue('COUNT'));\r\n\t\tlet result;\r\n\r\n\t\tif (needDelete) {\r\n\t\t\tresult = initialCount;\r\n\t\t} else {\r\n\t\t\tresult = initialCount - count;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trender(item, basket) {\r\n\t\tsuper.render(item, basket);\r\n\t\tthis.handleInputChange(true);\r\n\t\tthis.handleDeleteToggle(true);\r\n\t}\r\n\r\n\tcolumnCount(item, key) {\r\n\t\tif (!this.hasAction(ItemEdit.ACTION_ITEM)) { return super.columnCount(item, key); }\r\n\r\n\t\tconst value = this.value(item, key);\r\n\t\tconst valueSanitized = parseFloat(value) || '';\r\n\r\n\t\treturn `<td class=\"for--${kebabCase(key)}\">\r\n\t\t\t<input type=\"hidden\" name=\"${this.getName('INITIAL_COUNT')}\" value=\"${valueSanitized}\" />\r\n\t\t\t<div class=\"ui-ctl ui-ctl-sm ui-ctl-textbox ui-ctl-w100\">\r\n\t\t\t\t<input\r\n\t\t\t\t\tclass=\"ui-ctl-element\"\r\n\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\tname=\"${this.getName('COUNT')}\"\r\n\t\t\t\t\tvalue=\"${valueSanitized}\"\r\n\t\t\t\t\tmin=\"1\"\r\n\t\t\t\t\tmax=\"${valueSanitized}\"\r\n\t\t\t\t\tstep=\"1\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</td>`;\r\n\t}\r\n\r\n\trenderActions() {\r\n\t\tif (!this.hasAction(ItemEdit.ACTION_ITEM)) { return ''; }\r\n\r\n\t\treturn `<td class=\"for--delete\">\r\n\t\t\t<label class=\"yamarket-delete-toggle\">\r\n\t\t\t\t<input class=\"yamarket-delete-toggle__input\" type=\"checkbox\" name=\"${this.getName('DELETE')}\" value=\"Y\" />\r\n\t\t\t\t<span class=\"yamarket-delete-toggle__icon icon--delete\" title=\"${this.getMessage('ITEM_DELETE')}\">${this.getMessage('ITEM_DELETE')}</span>\r\n\t\t\t\t<span class=\"yamarket-delete-toggle__icon icon--restore\" title=\"${this.getMessage('ITEM_RESTORE')}\">${this.getMessage('ITEM_RESTORE')}</span>\r\n\t\t\t</label>\r\n\t\t</td>`;\r\n\t}\r\n\r\n\tgetInputValue(field) {\r\n\t\tconst input = this.getInput(field);\r\n\t\tlet result;\r\n\r\n\t\tif (input == null) { return null; }\r\n\r\n\t\tif (input.type === 'checkbox') {\r\n\t\t\tresult = input.checked ? input.value : null;\r\n\t\t} else {\r\n\t\t\tresult = input.value;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tgetInput(field) {\r\n\t\tconst name = this.getName(field);\r\n\r\n\t\treturn this.el.querySelector(`input[name=\"${name}\"]`);\r\n\t}\r\n}","import ReferenceField from \"../reference/field\";\r\nimport ItemView from \"./itemview\";\r\nimport ItemEdit from \"./itemedit\";\r\nimport { htmlToElement, kebabCase } from \"../utils\";\r\nimport './basket.css';\r\n\r\nexport default class Field extends ReferenceField {\r\n\tstatic messages = {}\r\n\tstatic defaults = {\r\n\t\tname: 'BASKET',\r\n\t\tactions: [],\r\n\t}\r\n\r\n\tstatic create(id, settings) {\r\n\t\tconst instance = new Field();\r\n\t\tinstance.initialize(id, settings);\r\n\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.items = [];\r\n\t}\r\n\r\n\tcountChanges() {\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const item of this.items) {\r\n\t\t\tif (!(item instanceof ItemEdit)) { continue; }\r\n\r\n\t\t\tconst diff = item.getCountDiff();\r\n\r\n\t\t\tif (diff > 0) {\r\n\t\t\t\tresult.push({\r\n\t\t\t\t\tname: item.getTitle(),\r\n\t\t\t\t\tdiff: diff,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\trender(payload) {\r\n\t\tconst basket = payload['VALUE'];\r\n\t\tconst table = this.renderTable(basket);\r\n\t\tconst body = table.querySelector('tbody');\r\n\r\n\t\tthis.extendOptions(payload);\r\n\r\n\t\tthis.renewItems(basket.ITEMS).forEach((basketItem, index) => {\r\n\t\t\tbasketItem.render(basket.ITEMS[index], basket);\r\n\t\t\tbasketItem.mount(body);\r\n\t\t});\r\n\r\n\t\tthis._wrapper.appendChild(table);\r\n\t}\r\n\r\n\textendOptions(payload) {\r\n\t\tthis.options = Object.assign(this.options, {\r\n\t\t\tactions: payload['ACTIONS'],\r\n\t\t});\r\n\t}\r\n\r\n\trenewItems(payloadItems) {\r\n\t\tthis.destroyItems();\r\n\r\n\t\treturn this.createItems(payloadItems);\r\n\t}\r\n\r\n\tdestroyItems() {\r\n\t\tfor (const item of this.items) {\r\n\t\t\titem.destroy();\r\n\t\t}\r\n\r\n\t\tthis.items = [];\r\n\t}\r\n\r\n\tcreateItems(payloadItems) {\r\n\t\tlet itemIndex = 0;\r\n\r\n\t\tthis.items = [];\r\n\r\n\t\tfor (const payloadItem of payloadItems) {\r\n\t\t\tthis.items.push(this.createItem(itemIndex));\r\n\t\t\t++itemIndex;\r\n\t\t}\r\n\r\n\t\treturn this.items;\r\n\t}\r\n\r\n\tcreateItem(index) {\r\n\t\tconst options = {\r\n\t\t\tmessages: Field.messages,\r\n\t\t\tname: `${this.options.name}[${index}]`,\r\n\t\t\tactions: this.options.actions,\r\n\t\t\tonChange: this.hasAction(ItemEdit.ACTION_CIS) || this.hasAction(ItemEdit.ACTION_DIGITAL)\r\n\t\t\t\t? () => {\r\n\t\t\t\t\tif (this._mode !== BX.UI.EntityEditorMode.edit) {\r\n\t\t\t\t\t\tthis._mode = BX.UI.EntityEditorMode.edit;\r\n\t\t\t\t\t\tthis._editor.showToolPanel();\r\n\t\t\t\t\t\tthis._editor.registerActiveControl(this);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._changeHandler();\r\n\t\t\t\t}\r\n\t\t\t\t: this._changeHandler,\r\n\t\t};\r\n\r\n\t\tif (this._mode === BX.UI.EntityEditorMode.edit) {\r\n\t\t\treturn new ItemEdit(options);\r\n\t\t}\r\n\r\n\t\treturn new ItemView(options);\r\n\t}\r\n\r\n\trenderTable(basket) {\r\n\t\treturn htmlToElement(`<div class=\"yamarket-basket\">\r\n\t\t\t<div class=\"yamarket-basket-table-viewport\">\r\n\t\t\t\t<table class=\"yamarket-basket-table\">\r\n\t\t\t\t\t${this.renderHeader(basket)}\r\n\t\t\t\t\t<tbody></tbody>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t\t${this.renderSummary(basket)}\r\n\t\t</div>`);\r\n\t}\r\n\r\n\trenderHeader(basket) {\r\n\t\treturn `<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<td class=\"for--index\">&numero;</td>\r\n\t\t\t\t${Object.keys(basket.COLUMNS)\r\n\t\t\t\t\t.map((key) => `<td class=\"for--${kebabCase(key)}\">${this.columnTitle(basket, key)}</td>`)\r\n\t\t\t\t\t.join('')}\r\n\t\t\t\t${this.isInEditMode() && this.hasAction(ItemEdit.ACTION_ITEM) ? '<td class=\"for--delete\">&nbsp;</td>' : ''}\r\n\t\t\t</tr>\r\n\t\t</thead>`;\r\n\t}\r\n\r\n\tcolumnTitle(basket, key) {\r\n\t\tconst langKey = 'HEADER_' + key;\r\n\t\tconst lang = this.getMessage(langKey);\r\n\r\n\t\treturn lang !== langKey ? lang : basket.COLUMNS[key];\r\n\t}\r\n\r\n\trenderSummary(basket) {\r\n\t\tif (basket.SUMMARY.length === 0) { return ''; }\r\n\r\n\t\treturn `<div class=\"yamarket-basket-summary\">\r\n\t\t\t${basket.SUMMARY\r\n\t\t\t\t.map((item) => {\r\n\t\t\t\t\treturn `<div class=\"yamarket-basket-summary__row\">\r\n\t\t\t\t\t\t<div class=\"yamarket-basket-summary__label\">${item['NAME']}:</div>\r\n\t\t\t\t\t\t<div class=\"yamarket-basket-summary__value\">${item['VALUE']}</div>\r\n\t\t\t\t\t</div>`;\r\n\t\t\t\t})\r\n\t\t\t\t.join('')}\r\n\t\t</div>`;\r\n\t}\r\n\r\n\thasAction(type) {\r\n\t\treturn this.options.actions.indexOf(type) !== -1;\r\n\t}\r\n}","import ReferenceField from \"../reference/field\";\r\nimport { htmlToElement, copyValues } from \"../utils\";\r\n\r\nexport default class Field extends ReferenceField {\r\n\tstatic messages = {}\r\n\tstatic defaults = {\r\n\t\tname: 'BASKET_CONFIRM',\r\n\t\treasons: [],\r\n\t}\r\n\r\n\tstatic create(id, settings) {\r\n\t\tconst instance = new Field();\r\n\t\tinstance.initialize(id, settings);\r\n\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tvalidate(validator) {\r\n\t\tconst basket = this._parent.getChildById('BASKET');\r\n\r\n\t\tif (basket == null) { return; }\r\n\r\n\t\tconst countChanges = basket.countChanges();\r\n\r\n\t\tif (countChanges.length === 0) { return; }\r\n\r\n\t\treturn this.showDialog(countChanges, validator);\r\n\t}\r\n\r\n\tshowDialog(countChanges, validator) {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tconst messageBox = BX.UI.Dialogs.MessageBox.create({\r\n\t\t\t\ttitle: this.getMessage('MODAL_TITLE'),\r\n\t\t\t\tmessage: this.dialogBody(countChanges),\r\n\t\t\t});\r\n\r\n\t\t\tmessageBox.setButtons([\r\n\t\t\t\tnew BX.UI.SendButton({\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tclick: this.onSendClick.bind(this, messageBox, resolve),\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tnew BX.UI.CancelButton({\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tclick: this.onCancelClick.bind(this, messageBox, validator, resolve),\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t]);\r\n\r\n\t\t\tmessageBox.show();\r\n\t\t});\r\n\t}\r\n\r\n\tdialogBody(countChanges) {\r\n\t\treturn `\r\n\t\t\t<div class=\"ui-form-row\">\r\n\t\t\t\t<div class=\"ui-form-label\">\r\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${this.getMessage('REASON')}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"ui-form-content\">\r\n\t\t\t\t\t${this.reasonControl()}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"ui-form-row\">\r\n\t\t\t\t<div class=\"ui-form-label\">\r\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${this.getMessage('PRODUCTS')}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"ui-form-content\">\r\n\t\t\t\t\t${this.productsControl(countChanges)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"ui-alert ui-alert-warning\">${this.getMessage('FORM_INTRO')}</div>\r\n\t\t`;\r\n\t}\r\n\r\n\treasonControl() {\r\n\t\treturn `<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\r\n\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\r\n\t\t\t<select class=\"ui-ctl-element\" name=\"${this.options.name}[REASON]\">\r\n\t\t\t\t${this.options.reasons.map((option) => `<option value=\"${option['ID']}\">${option['VALUE']}</option>`).join('')}\r\n\t\t\t</select>\r\n\t\t</div>`\r\n\t}\r\n\r\n\tproductsControl(changes) {\r\n\t\treturn changes\r\n\t\t\t.map((change) => {\r\n\t\t\t\treturn this.getMessage('ITEM_CHANGE', {\r\n\t\t\t\t\tNAME: change.name,\r\n\t\t\t\t\tCOUNT: change.diff,\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.join('<hr />');\r\n\t}\r\n\r\n\tonSendClick(messageBox, resolve) {\r\n\t\tcopyValues(messageBox.popupWindow.contentContainer, this.el);\r\n\t\tmessageBox.close();\r\n\t\tresolve();\r\n\t}\r\n\r\n\tonCancelClick(messageBox, validator, resolve) {\r\n\t\tconst error = BX.UI.EntityValidationError.create({\r\n\t\t\tfield: this,\r\n\t\t});\r\n\r\n\t\tvalidator.addError(error);\r\n\t\tmessageBox.close();\r\n\t\tresolve();\r\n\t}\r\n\r\n\trender(payload) {\r\n\t\tthis.extendOptions(payload);\r\n\r\n\t\tthis.el = htmlToElement(`<div class=\"ui-helper-hidden\">\r\n\t\t\t<input type=\"hidden\" name=\"${this.options.name}[REASON]\" value=\"\" />\r\n\t\t</div>`)\r\n\r\n\t\tthis._wrapper.appendChild(this.el);\r\n\t}\r\n\r\n\textendOptions(payload) {\r\n\t\tthis.options = Object.assign(this.options, {\r\n\t\t\treasons: payload['ITEMS_CHANGE_REASON'],\r\n\t\t});\r\n\t}\r\n}","import { htmlToElement } from \"../utils\";\r\nimport './box.css';\r\n\r\nexport default class ItemView {\r\n\tstatic defaults = {\r\n\t\tname: null,\r\n\t\tmessages: {},\r\n\t\tboxProperties: {},\r\n\t\tboxDimensions: {},\r\n\t\tuseDimensions: false,\r\n\t\tfulfilmentBase: null,\r\n\t\tonChange: null,\r\n\t}\r\n\r\n\tconstructor(options) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\tgetMessage(key) {\r\n\t\treturn this.options.messages[key] || key;\r\n\t}\r\n\r\n\ttoggleUseDimensions(enabled) {\r\n\t\tthis.options.useDimensions = enabled;\r\n\t}\r\n\r\n\trender(value) {\r\n\t\tthis.el = htmlToElement(`<div class=\"yamarket-box\">\r\n\t\t\t${this.buildDefined(value)}\r\n\t\t\t${this.buildHeader(value)}\r\n\t\t\t${this.buildBody(value)}\r\n\t\t</div>`);\r\n\t}\r\n\r\n\tbuildDefined(value) {\r\n\t\tconst keys = [\r\n\t\t\t'FULFILMENT_ID',\r\n\t\t];\r\n\t\tlet result = '';\r\n\r\n\t\tfor (const key of keys) {\r\n\t\t\tresult += `<input type=\"hidden\" name=\"${this.options.name}[${key}]\" value=\"${BX.util.htmlspecialchars(value[key] || '')}\" />`;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tbuildSizes(value) {\r\n\t\tif (!this.options.useDimensions) { return ''; }\r\n\r\n\t\treturn `${Object.keys(this.options.boxDimensions).map((name) => {\r\n\t\t\tconst inputName = this.getName('DIMENSIONS') + `[${name}]`;\r\n\t\t\tconst inputValue = value?.DIMENSIONS?.[name]?.['VALUE'] || '';\r\n\t\t\t\r\n\t\t\tif (inputValue === '') { return ''; }\r\n\r\n\t\t\treturn `<input type=\"hidden\" name=\"${inputName}\" value=\"${BX.util.htmlspecialchars(inputValue)}\" data-name=\"${name}\" />`;\r\n\t\t}).join('')}`;\r\n\t}\r\n\r\n\tbuildHeader(value) {\r\n\t\treturn `<div class=\"yamarket-box__header\">\r\n\t\t\t<div class=\"yamarket-box__title\">\r\n\t\t\t\t${this.getMessage('BOX')}\r\n\t\t\t\t&numero;${value['NUMBER']}\r\n\t\t\t</div>\r\n\t\t\t${this.buildProperties(value)}\r\n\t\t\t${this.buildActions(value)}\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildProperties(value) {\r\n\t\tconst disabled = this.disabledProperties();\r\n\r\n\t\treturn `<div class=\"yamarket-box__properties\">\r\n\t\t\t${Object.entries(this.options.boxProperties).map(([name,property]) => {\r\n\t\t\t\tconst propertyValue = value?.PROPERTIES?.[name] || '';\r\n\t\t\t\t\r\n\t\t\t\tif (propertyValue === '' || disabled.indexOf(name) !== -1) { return ''; }\r\n\t\t\t\t\r\n\t\t\t\treturn `<div class=\"yamarket-box__property\">\r\n\t\t\t\t\t${property['NAME']}: ${propertyValue} ${property['UNIT_FORMATTED'] || ''}\r\n\t\t\t\t</div>`;\r\n\t\t\t}).join('')}\r\n\t\t</div>`\r\n\t}\r\n\r\n\tdisabledProperties() {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tbuildActions(value) {\r\n\t\treturn '';\r\n\t}\r\n\r\n\tbuildBody(value) {\r\n\t\treturn this.buildSizes(value);\r\n\t}\r\n\r\n\tmount(point, after) {\r\n\t\tif (after != null) {\r\n\t\t\tafter.after(this.el);\r\n\t\t} else {\r\n\t\t\tpoint.appendChild(this.el);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateNumber(number) {\r\n\t\tconst title = this.el.querySelector('.yamarket-box__title');\r\n\t\tconst fulfilmentId = this.el.querySelector('input[name$=\"[FULFILMENT_ID]\"]');\r\n\r\n\t\ttitle.innerHTML = `${this.getMessage('BOX')} &numero;${number}`;\r\n\t\tfulfilmentId.value = this.options.fulfilmentBase + number;\r\n\t}\r\n\r\n\tgetName(field) {\r\n\t\treturn this.options.name + '[' + field + ']';\r\n\t}\r\n\r\n\tfireChange() {\r\n\t\tthis.options.onChange && this.options.onChange();\r\n\t}\r\n}","import ItemView from \"./itemview\";\r\nimport './box.css';\r\n\r\nexport default class ItemEdit extends ItemView {\r\n\r\n\tdestroy() {\r\n\t\tthis.unbind();\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.handleInputChange(false);\r\n\t\tthis.handleDeleteClick(false);\r\n\t}\r\n\r\n\thandleInputChange(dir) {\r\n\t\tif (!this.options.onChange) { return; }\r\n\r\n\t\tthis.el.querySelectorAll('input').forEach((input) => {\r\n\t\t\tif (input.type === 'hidden') { return; }\r\n\r\n\t\t\tinput[dir ? 'addEventListener' : 'removeEventListener']('change', this.options.onChange);\r\n\t\t});\r\n\t}\r\n\r\n\thandleDeleteClick(dir) {\r\n\t\tconst button = this.el.querySelector('.yamarket-box__delete');\r\n\r\n\t\tif (!button) { return; }\r\n\r\n\t\tbutton[dir ? 'addEventListener' : 'removeEventListener']('click', this.onDeleteClick);\r\n\t}\r\n\r\n\tonDeleteClick = (evt) => {\r\n\t\tthis.remove();\r\n\t\tevt.preventDefault();\r\n\t}\r\n\r\n\ttoggleUseDimensions(enabled) {\r\n\t\tsuper.toggleUseDimensions(enabled);\r\n\r\n\t\tif (this.el == null) { return; }\r\n\r\n\t\tconst body = this.el.querySelector('.yamarket-box__body');\r\n\r\n\t\tif (body == null) { return; }\r\n\r\n\t\tif (enabled) {\r\n\t\t\tbody.classList.remove('is--disabled');\r\n\t\t} else {\r\n\t\t\tbody.classList.add('is--disabled');\r\n\t\t}\r\n\t}\r\n\r\n\tremove() {\r\n\t\tthis.fireRemove();\r\n\t\tthis.destroy();\r\n\t\tthis.el.remove();\r\n\t}\r\n\r\n\tfireRemove() {\r\n\t\tthis.el.dispatchEvent(new CustomEvent('yamarketBoxDelete', {\r\n\t\t\tdetail: {\r\n\t\t\t\titem: this,\r\n\t\t\t},\r\n\t\t\tbubbles: true,\r\n\t\t}));\r\n\t}\r\n\r\n\trender(value) {\r\n\t\tsuper.render(value);\r\n\t\tthis.handleInputChange(true);\r\n\t\tthis.handleDeleteClick(true);\r\n\t}\r\n\r\n\tdisabledProperties() {\r\n\t\treturn [\r\n\t\t\t'SIZE',\r\n\t\t\t'WEIGHT',\r\n\t\t];\r\n\t}\r\n\r\n\tbuildActions(value) {\r\n\t\treturn `<div class=\"yamarket-box__actions\">\r\n\t\t\t<span class=\"yamarket-box__delete ui-entity-editor-header-edit-lnk\">${this.getMessage('BOX_DELETE')}</span>\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildBody(value) {\r\n\t\treturn `<div class=\"yamarket-box__body ${this.options.useDimensions ? '' : 'is--disabled'}\">\r\n\t\t\t${this.buildSizes(value)}\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildSizes(value) {\r\n\t\treturn `<div class=\"yamarket-box__sizes\">\r\n\t\t\t${Object.entries(this.options.boxDimensions).map(([name, property]) => {\r\n\t\t\t\tconst inputName = this.getName('DIMENSIONS') + `[${name}]`;\r\n\t\t\t\tconst inputValue = value?.DIMENSIONS?.[name]?.['VALUE'] || '';\r\n\t\r\n\t\t\t\treturn `<div class=\"yamarket-box__size\">\r\n\t\t\t\t\t<div class=\"ui-entity-editor-content-block ui-entity-editor-field-text\">\r\n\t\t\t\t\t\t<div class=\"ui-entity-editor-block-title ui-entity-widget-content-block-title-edit\">\r\n\t\t\t\t            <label class=\"ui-entity-editor-block-title-text\">${property['NAME']}${property['UNIT_FORMATTED'] ? ', ' + property['UNIT_FORMATTED'] : ''}</label>\r\n\t\t\t\t        </div>\r\n\t\t\t\t        <div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\r\n\t\t\t\t            <input class=\"ui-ctl-element\" type=\"text\" name=\"${inputName}\" value=\"${BX.util.htmlspecialchars(inputValue)}\" size=\"6\" data-name=\"${name}\" />\r\n\t\t\t\t        </div>\r\n\t\t\t       </div>\r\n\t\t\t\t</div>`;\r\n\t\t\t}).join('')}\r\n\t\t</div>`;\r\n\t}\r\n}","import ItemView from './itemview';\r\nimport ItemEdit from './itemedit';\r\nimport { htmlToElement } from \"../utils\";\r\n\r\nexport default class Collection {\r\n\tstatic defaults = {\r\n\t\tname: null,\r\n\t\tmessages: {},\r\n\t\tboxProperties: {},\r\n\t\tboxDimensions: {},\r\n\t\tuseDimensions: false,\r\n\t\tfulfilmentBase: null,\r\n\t\tonChange: null,\r\n\t}\r\n\r\n\tconstructor(options) {\r\n\t\tthis.options = Object.assign({}, this.constructor.defaults, options);\r\n\t}\r\n\r\n\tgetMessage(key) {\r\n\t\treturn this.options.messages[key] || key;\r\n\t}\r\n\r\n\thandleItemRemove() {\r\n\t\tthis.el.addEventListener('yamarketBoxDelete', this.onItemRemove);\r\n\t}\r\n\r\n\thandleAddClick(button) {\r\n\t\tbutton.addEventListener('click', this.onAddClick);\r\n\t}\r\n\r\n\tonItemRemove = (evt) => {\r\n\t\tconst item = evt.detail.item;\r\n\r\n\t\tthis.releaseItem(item);\r\n\t\tthis.renewNumber();\r\n\t\tthis.fireChange();\r\n\t}\r\n\r\n\tonAddClick = (evt) => {\r\n\t\tthis.addItem();\r\n\t\tthis.fireChange();\r\n\r\n\t\tevt.preventDefault();\r\n\t}\r\n\r\n\ttoggleUseDimensions(enabled) {\r\n\t\tthis.options.useDimensions = enabled;\r\n\r\n\t\tif (this.items == null) { return; }\r\n\r\n\t\tfor (const item of this.items) {\r\n\t\t\titem.toggleUseDimensions(enabled);\r\n\t\t}\r\n\t}\r\n\r\n\trender(value) {\r\n\t\tthis.renderSelf();\r\n\t\tthis.renderItems(value);\r\n\t\tthis.renderAddButton();\r\n\t}\r\n\r\n\trenderSelf() {\r\n\t\tthis.el = htmlToElement(`<div class=\"yamarket-boxes\"></div>`);\r\n\t}\r\n\r\n\trenderItems(value) {\r\n\t\tconst items = [];\r\n\t\tlet index = 0;\r\n\r\n\t\tfor (const one of value) {\r\n\t\t\tconst box = this.createItem(index);\r\n\r\n\t\t\tbox.render(one);\r\n\t\t\tbox.mount(this.el);\r\n\r\n\t\t\titems.push(box);\r\n\r\n\t\t\t++index;\r\n\t\t}\r\n\r\n\t\tthis.items = items;\r\n\t\tthis.nextIndex = index;\r\n\r\n\t\tthis.handleItemRemove();\r\n\t}\r\n\r\n\tcreateItem(index) {\r\n\t\tconst options = {\r\n\t\t\tname: this.options.name + `[${index}]`,\r\n\t\t\tmessages: this.options.messages,\r\n\t\t\tboxProperties: this.options.boxProperties,\r\n\t\t\tboxDimensions: this.options.boxDimensions,\r\n\t\t\tuseDimensions: this.options.useDimensions,\r\n\t\t\tfulfilmentBase: this.options.fulfilmentBase,\r\n\t\t\tonChange: this.options.onChange,\r\n\t\t};\r\n\r\n\t\tif (this.options.mode === BX.UI.EntityEditorMode.edit) {\r\n\t\t\treturn new ItemEdit(options);\r\n\t\t}\r\n\r\n\t\treturn new ItemView(options);\r\n\t}\r\n\r\n\treleaseItem(item) {\r\n\t\tconst index = this.items.indexOf(item);\r\n\r\n\t\tif (index === -1) { return; }\r\n\r\n\t\tthis.items.splice(index, 1);\r\n\t}\r\n\r\n\trenewNumber() {\r\n\t\tlet num = 1;\r\n\r\n\t\tfor (const box of this.items) {\r\n\t\t\tbox.updateNumber(num);\r\n\t\t\t++num;\r\n\t\t}\r\n\t}\r\n\r\n\taddItem() {\r\n\t\tconst number = this.items.length + 1;\r\n\t\tconst box = this.createItem(this.nextIndex);\r\n\t\tconst last = this.items[this.items.length - 1]?.el;\r\n\r\n\t\tbox.render({\r\n\t\t\t'FULFILMENT_ID': this.options.fulfilmentBase + number,\r\n\t\t\t'NUMBER': number,\r\n\t\t});\r\n\t\tbox.mount(this.el, last);\r\n\r\n\t\tthis.items.push(box);\r\n\t\t++this.nextIndex;\r\n\t}\r\n\r\n\trenderAddButton() {\r\n\t\tif (this.options.mode !== BX.UI.EntityEditorMode.edit) { return ''; }\r\n\r\n\t\tconst addButton = htmlToElement(`<span class=\"yamarket-boxes__add ui-entity-editor-content-create-lnk\">${this.getMessage('BOX_ADD')}</span>`);\r\n\r\n\t\tthis.el.appendChild(addButton);\r\n\t\tthis.handleAddClick(addButton);\r\n\t}\r\n\r\n\tfireChange() {\r\n\t\tthis.options.onChange && this.options.onChange();\r\n\t}\r\n\r\n\tmount(point) {\r\n\t\tpoint.appendChild(this.el);\r\n\t}\r\n}","import ReferenceField from \"../reference/field\";\r\nimport BoxCollection from \"../box/collection\";\r\nimport {htmlToElement} from \"../utils\";\r\n\r\nexport default class Field extends ReferenceField {\r\n\tstatic messages = {}\r\n\tstatic defaults = {\r\n\t\tname: 'SHIPMENT',\r\n\t\tactions: [],\r\n\t}\r\n\r\n\tstatic create(id, settings) {\r\n\t\tconst instance = new Field();\r\n\t\tinstance.initialize(id, settings);\r\n\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tinitialize(id, settings) {\r\n\t\tsuper.initialize(id, settings);\r\n\t\tthis.handleTitleActions(true);\r\n\t}\r\n\r\n\trelease() {\r\n\t\tthis.handleTitleActions(false);\r\n\t\tsuper.release();\r\n\t}\r\n\r\n\thandleTitleActions(dir) {\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](window, 'BX.UI.EntityEditorSection:onLayout', this.onTitleActions);\r\n\t}\r\n\r\n\thandleUseDimensionsChange(node, dir) {\r\n\t\tnode[dir ? 'addEventListener' : 'removeEventListener']('change', this.onUseDimensionsChange);\r\n\t}\r\n\r\n\tonTitleActions = (field, context) => {\r\n\t\tif (field !== this.getParent()) { return; }\r\n\r\n\t\tconst useDimensionsNode = field.isInEditMode()\r\n\t\t\t? this.renderUseDimensions(this.useDimensions)\r\n\t\t\t: this.definedUseDimensions(this.useDimensions);\r\n\r\n\t\tcontext.customNodes.push(useDimensionsNode);\r\n\t}\r\n\r\n\tonUseDimensionsChange = (evt) => {\r\n\t\tconst enabled = evt.target.checked;\r\n\r\n\t\tthis.toggleUseDimensions(enabled);\r\n\t\tthis.markAsChanged();\r\n\t}\r\n\r\n\trender(payload) {\r\n\t\tthis.syncUseDimensions(payload['USE_DIMENSIONS']);\r\n\t\tthis.renderShipments(payload['VALUE'], {\r\n\t\t\tfulfilmentBase: payload['FULFILMENT_BASE'],\r\n\t\t\tboxProperties: payload['BOX_PROPERTIES'],\r\n\t\t\tboxDimensions: payload['BOX_DIMENSIONS'],\r\n\t\t\tuseDimensions: payload['USE_DIMENSIONS'],\r\n\t\t});\r\n\t}\r\n\r\n\tdefinedUseDimensions(enabled = false) {\r\n\t\treturn htmlToElement(`<input type=\"hidden\" name=\"USE_DIMENSIONS\" value=\"${enabled ? 'Y' : 'N'}\" />`);\r\n\t}\r\n\r\n\trenderUseDimensions(enabled = false) {\r\n\t\tconst node = htmlToElement(`<div class=\"ui-entity-editor-field-checkbox\">\r\n\t\t\t<input type=\"hidden\" name=\"USE_DIMENSIONS\" value=\"N\" />\r\n\t\t\t<label class=\"ui-ctl ui-ctl-xs ui-ctl-wa ui-ctl-checkbox yamarket-boxes-use-dimensions\">\r\n\t\t\t\t<input class=\"ui-ctl-element\" type=\"checkbox\" name=\"USE_DIMENSIONS\" value=\"Y\" ${enabled ? 'checked' : ''} />\r\n\t\t\t\t<div class=\"ui-ctl-label-text\">${this.getMessage('USE_DIMENSIONS')}</div>\r\n\t\t\t</label>\r\n\t\t</div>`);\r\n\t\tconst checkbox = node.querySelector('input[type=\"checkbox\"]');\r\n\r\n\t\tthis.handleUseDimensionsChange(checkbox, true);\r\n\r\n\t\treturn node;\r\n\t}\r\n\r\n\tsyncUseDimensions(enabled) {\r\n\t\tthis.useDimensions = enabled;\r\n\t}\r\n\r\n\ttoggleUseDimensions(enabled) {\r\n\t\tif (this.shipmentBoxes == null) { return; }\r\n\r\n\t\tfor (const boxCollection of this.shipmentBoxes) {\r\n\t\t\tboxCollection.toggleUseDimensions(enabled);\r\n\t\t}\r\n\t}\r\n\r\n\trenderShipmentTitle(shipment) {\r\n\t\tconst html = `<div class=\"ui-entity-editor-block-title\">\r\n\t\t\t<span class=\"ui-entity-editor-block-title-text\">${this.getMessage('SHIPMENT', { 'ID': shipment['ID'] })}</span>\r\n\t\t</div>`;\r\n\r\n\t\tthis._wrapper.insertAdjacentHTML('beforeend', html);\r\n\t}\r\n\r\n\trenderShipments(shipmentCollection, options) {\r\n\t\tthis.shipmentBoxes = [];\r\n\r\n\t\tif (!Array.isArray(shipmentCollection)) { shipmentCollection = []; }\r\n\r\n\t\tconst hasFew = shipmentCollection.length > 1;\r\n\t\tlet index = 0;\r\n\r\n\t\tfor (const shipment of shipmentCollection) {\r\n\t\t\tif (hasFew) {\r\n\t\t\t\tthis.renderShipmentTitle(shipment);\r\n\t\t\t}\r\n\r\n\t\t\tthis.renderShipment(shipment, Object.assign(options, {\r\n\t\t\t\tname: `${this.options.name}[${index}]`,\r\n\t\t\t}));\r\n\r\n\t\t\t++index;\r\n\t\t}\r\n\t}\r\n\r\n\trenderShipment(shipment, options) {\r\n\t\tthis.renderShipmentDefined(shipment, options);\r\n\t\tthis.renderBoxCollection(shipment['BOX'], options);\r\n\t}\r\n\r\n\trenderShipmentDefined(shipment, options) {\r\n\t\tconst keys = [\r\n\t\t\t'ID',\r\n\t\t];\r\n\r\n\t\tfor (const key of keys) {\r\n\t\t\tif (shipment[key] == null) { continue; }\r\n\r\n\t\t\tthis._wrapper.insertAdjacentHTML(\r\n\t\t\t\t'afterbegin',\r\n\t\t\t\t`<input type=\"hidden\" name=\"${options.name}[${key}]\" value=\"${shipment[key]}\" />`\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\trenderBoxCollection(shipment, options) {\r\n\t\tconst boxCollection = new BoxCollection(Object.assign(options, {\r\n\t\t\tmessages: Field.messages,\r\n\t\t\tmode: this._mode,\r\n\t\t\tname: options.name + '[BOX]',\r\n\t\t\tonChange: this._changeHandler,\r\n\t\t}));\r\n\r\n\t\tboxCollection.render(shipment);\r\n\t\tboxCollection.mount(this._wrapper);\r\n\r\n\t\tthis.shipmentBoxes.push(boxCollection);\r\n\t}\r\n}\r\n","import ReferenceField from \"../reference/field\";\r\nimport {htmlToElement} from \"../utils\";\r\n\r\nexport default class Field extends ReferenceField {\r\n\tstatic messages = {}\r\n\tstatic defaults = {\r\n\t\tbroadcastElement: '#YAMARKET_ORDER_VIEW',\r\n\t}\r\n\r\n\tstatic create(id, settings) {\r\n\t\tconst instance = new Field();\r\n\t\tinstance.initialize(id, settings);\r\n\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tuseTitle() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tbind() {\r\n\t\tthis.handleActivityEnd(true);\r\n\t}\r\n\r\n\tunbind() {\r\n\t\tthis.handleActivityEnd(false);\r\n\t}\r\n\r\n\thandleActivityEnd(dir) {\r\n\t\tif (this._activityType == null) { return; }\r\n\r\n\t\tconst broadcast = this.getElement('broadcast');\r\n\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](broadcast, 'yamarketActivitySubmitEnd', this.onActivityEnd);\r\n\t}\r\n\r\n\tonActivityEnd = (type) => {\r\n\t\tif (!this.isMatchActivity(type)) { return; }\r\n\r\n\t\tthis._editor.reload();\r\n\t}\r\n\r\n\tisMatchActivity(type) {\r\n\t\tif (type == null) { return false; }\r\n\r\n\t\treturn (type === this._activityType || type.indexOf(this._activityType + '|') === 0);\r\n\t}\r\n\r\n\tforget() {\r\n\t\tif (!this.el) { return; }\r\n\r\n\t\tthis.unbind();\r\n\t}\r\n\r\n\trender(payload) {\r\n\t\tconst html = this.build(payload);\r\n\r\n\t\tthis._activityType = payload?.ACTIVITY_ACTION?.TYPE;\r\n\r\n\t\tthis.el = htmlToElement(html);\r\n\t\tthis.bind();\r\n\r\n\t\tthis._wrapper.appendChild(this.el);\r\n\t}\r\n\r\n\tbuild(payload) {\r\n\t\tconst activity = payload['ACTIVITY_ACTION'];\r\n\r\n\t\treturn `<div class=\"ui-entity-editor-content-block\">\r\n\t\t\t<div class=\"ui-entity-editor-content-block-text\">\r\n\t\t\t\t${BX.util.htmlspecialchars(payload['VALUE'])}\r\n\t\t\t\t${activity ? this.buildActivity(activity, payload) : ''}\r\n\t\t\t</div>\r\n\t\t</div>`;\r\n\t}\r\n\r\n\tbuildActivity(activity, property) {\r\n\t\tconst title = activity['TEXT'] !== property['NAME'] ? activity['TEXT'] : this.getMessage('ACTIVITY_APPLY');\r\n\t\tconst onclick = this.makeActivityMethod(activity);\r\n\r\n\t\treturn `<small>\r\n\t\t\t<a href=\"#\" onclick='${onclick}; return false'>${title}</a>\r\n\t\t</small>`;\r\n\t}\r\n\r\n\tmakeActivityMethod(activity) {\r\n\t\tlet result;\r\n\r\n\t\tif (activity['MENU'] != null) {\r\n\t\t\tconst items = activity['MENU'].map((action) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttext: action['TEXT'],\r\n\t\t\t\t\tonclick: action['METHOD'],\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t\t\tresult = `BX.PopupMenu.show(\"${activity['TYPE']}\", this, ${JSON.stringify(items)}, { angle: { offset: 50 } })`;\r\n\t\t} else {\r\n\t\t\tresult = activity['METHOD'];\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n}","import ReferenceField from \"../reference/field\";\r\nimport { htmlToElement } from \"../utils\";\r\nimport './print.css';\r\n\r\nexport default class Field extends ReferenceField {\r\n\tstatic messages = {}\r\n\tstatic defaults = {\r\n\t\turl: null,\r\n\t\twidth: 400,\r\n\t\theight: 300,\r\n\t\titems: [],\r\n\t}\r\n\r\n\tstatic create(id, settings) {\r\n\t\tconst instance = new Field();\r\n\t\tinstance.initialize(id, settings);\r\n\r\n\t\treturn instance;\r\n\t}\r\n\r\n\tbindDocumentsClick() {\r\n\t\tthis._wrapper.querySelectorAll('.yamarket-print__link').forEach((link) => {\r\n\t\t\tlink.addEventListener('click', this.onDocumentClick);\r\n\t\t});\r\n\t}\r\n\r\n\tonDocumentClick = (evt) => {\r\n\t\tconst link = evt.currentTarget;\r\n\t\tconst type = link.dataset.type;\r\n\t\tconst item = this.getItem(type);\r\n\t\tconst url = this.buildDocumentUrl(type);\r\n\t\tconst dialog = this.createDialog(url, item);\r\n\r\n\t\tdialog.Show();\r\n\r\n\t\tevt.preventDefault();\r\n\t}\r\n\r\n\tgetItem(type) {\r\n\t\tlet result;\r\n\r\n\t\tfor (const document of this.options.items) {\r\n\t\t\tif (document['TYPE'] === type) {\r\n\t\t\t\tresult = document;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tbuildDocumentUrl(type) {\r\n\t\tconst url = this.options.url;\r\n\r\n\t\treturn (\r\n\t\t\turl\r\n\t\t\t+ (url.indexOf('?') === -1 ? '?' : '&')\r\n\t\t\t+ 'type=' + type\r\n\t\t);\r\n\t}\r\n\r\n\tcreateDialog(url, item) {\r\n\t\treturn new BX.YandexMarket.PrintDialog({\r\n\t\t\ttitle: item.DIALOG_TITLE || item.TITLE,\r\n\t\t\tcontent_url: url,\r\n\t\t\twidth: item.WIDTH || this.options.width,\r\n\t\t\theight: item.HEIGHT || this.options.height,\r\n\t\t\tbuttons: [\r\n\t\t\t\tBX.YandexMarket.PrintDialog.btnSave,\r\n\t\t\t\tBX.YandexMarket.PrintDialog.btnCancel\r\n\t\t\t]\r\n\t\t});\r\n\t}\r\n\r\n\trender(value) {\r\n\t\tthis.extendOptions(value);\r\n\r\n\t\tthis.renderIntro();\r\n\t\tthis.renderDocuments(value['ITEMS']);\r\n\r\n\t\tthis.bindDocumentsClick();\r\n\t}\r\n\r\n\textendOptions(value) {\r\n\t\tthis.options = Object.assign(this.options, {\r\n\t\t\turl: value['URL'],\r\n\t\t\titems: value['ITEMS'],\r\n\t\t});\r\n\t}\r\n\r\n\trenderIntro() {\r\n\t\tconst element = htmlToElement(`<p class=\"yamarket-print__intro\">${this.getMessage('INTRO')}</p>`);\r\n\r\n\t\tthis._wrapper.appendChild(element);\r\n\t}\r\n\r\n\trenderDocuments(items) {\r\n\t\tif (!Array.isArray(items)) { return; }\r\n\r\n\t\tconst element = htmlToElement(`<ul class=\"yamarket-print__documents\">\r\n\t\t\t${items.map((document) => `<li class=\"yamarket-print__document\">\r\n\t\t\t\t<a class=\"yamarket-print__link\" href=\"#\" data-type=\"${document['TYPE']}\">${document['TITLE']}</a>\r\n\t\t\t</li>`).join('')}\r\n\t\t</ul>`);\r\n\r\n\t\tthis._wrapper.appendChild(element);\r\n\t}\r\n}","import ReferenceField from \"../reference/field\";\r\nimport './notification.css';\r\n\r\nexport default class Field extends ReferenceField {\r\n\r\n\tstatic defaults = {}\r\n\r\n\tstatic create(id, settings) {\r\n\t\tconst instance = new Field();\r\n\t\tinstance.initialize(id, settings);\r\n\r\n\t\treturn instance;\r\n\t}\r\n\r\n\trender(value) {\r\n\t\tif (!Array.isArray(value)) { return; }\r\n\r\n\t\tconst html = value.map((one) => `<div class=\"ui-alert ui-alert-${one.type}\">${one.text}</div>`).join('');\r\n\r\n\t\tthis._wrapper.insertAdjacentHTML('beforeend', html);\r\n\t}\r\n\r\n}","import Factory from \"./factory\";\r\nimport Basket from \"./basket/field\";\r\nimport BasketConfirm from \"./basketconfirm/field\";\r\nimport Shipment from \"./shipment/field\";\r\nimport Property from \"./property/field\";\r\nimport Print from \"./print/field\";\r\nimport Notification from \"./notification/field\";\r\nimport Editor from \"./compatible/editor\";\r\nimport './common.css';\r\n\r\n// factory\r\n\r\nconst factory = new Factory({\r\n\tmap: {\r\n\t\tnotification: Notification,\r\n\t\tbasket: Basket,\r\n\t\tbasket_confirm: BasketConfirm,\r\n\t\tshipment: Shipment,\r\n\t\tproperty: Property,\r\n\t\tprint: Print,\r\n\t},\r\n});\r\n\r\nfactory.register();\r\n\r\n// compatible\r\n\r\nconst editor = new Editor();\r\n\r\neditor.start();\r\n\r\nexport {\r\n\tNotification,\r\n\tBasket,\r\n\tBasketConfirm,\r\n\tShipment,\r\n\tProperty,\r\n\tPrint,\r\n};","export default class Editor {\r\n\r\n\tstart() {\r\n\t\tthis.storeOriginDefault();\r\n\t\tthis.handleEditorInit();\r\n\t}\r\n\r\n\thandleEditorInit() {\r\n\t\tBX.addCustomEvent(window, 'BX.UI.EntityEditor:onInit', this.onEditorInit);\r\n\t}\r\n\r\n\tonEditorInit = (editor, data) => {\r\n\t\tif (data.id !== 'yamarket_order_tab') { return; }\r\n\r\n\t\tthis.overrideEditor(editor);\r\n\t\tthis.overrideEditorAjax(editor);\r\n\t\tthis.restoreOriginDefault();\r\n\t}\r\n\r\n\tstoreOriginDefault() {\r\n\t\tthis._originDefault = BX?.UI?.EntityEditor?.getDefault();\r\n\t}\r\n\r\n\trestoreOriginDefault() {\r\n\t\tif (this._originDefault == null) { return; }\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tBX?.UI?.EntityEditor?.setDefault(this._originDefault);\r\n\t\t});\r\n\t}\r\n\r\n\toverrideEditor(editor) {\r\n\t\tconst createAjaxForm = editor.createAjaxForm;\r\n\r\n\t\tObject.assign(editor, {\r\n\t\t\tvalidate: this.editorValidate.bind(this, editor),\r\n\t\t\tcreateAjaxForm: this.editorCreateAjaxForm.bind(this, editor, createAjaxForm),\r\n\t\t});\r\n\t}\r\n\r\n\teditorValidate(editor, result) {\r\n\t\tconst validator = BX.UI.EntityAsyncValidator.create();\r\n\r\n\t\tfor (const control of editor._activeControls) {\r\n\t\t\tvalidator.addResult(control.validate(result));\r\n\t\t}\r\n\r\n\t\tif (this._userFieldManager) {\r\n\t\t\tvalidator.addResult(this._userFieldManager.validate(result));\r\n\t\t}\r\n\r\n\t\treturn Promise.resolve(validator.validate());\r\n\t}\r\n\r\n\teditorCreateAjaxForm(editor, parentMethod, options, callbacks) {\r\n\t\tconst result = parentMethod.call(editor, options, callbacks);\r\n\r\n\t\tthis.overrideAjaxForm(result);\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\toverrideEditorAjax(editor) {\r\n\t\tthis.overrideAjaxForm(editor._ajaxForm);\r\n\t}\r\n\r\n\toverrideAjaxForm(ajaxForm) {\r\n\t\tif (!ajaxForm || !BX?.UI?.ComponentAjax || !(ajaxForm instanceof BX.UI.ComponentAjax)) { return; }\r\n\r\n\t\tObject.assign(ajaxForm, {\r\n\t\t\tdoSubmit: this.ajaxFormDoSubmit,\r\n\t\t});\r\n\t}\r\n\r\n\tajaxFormDoSubmit(options) {\r\n\t\tconst formData = this._elementNode\r\n\t\t\t? BX.ajax.prepareForm(this._elementNode)\r\n\t\t\t: {data : BX.clone(this._formData), filesCount : 0};\r\n\r\n\t\tif (BX.type.isPlainObject(options.data)) {\r\n\t\t\tfor (const i in options.data) {\r\n\t\t\t\tif (!options.data.hasOwnProperty(i)) { continue; }\r\n\r\n\t\t\t\tformData.data[i] = options.data[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst resultData = formData.filesCount > 0 ? this.makeFormData(formData) : formData;\r\n\r\n\t\tBX.ajax.runComponentAction(this._className, this._actionName, {\r\n\t\t\tmode: 'ajax',\r\n\t\t\tsignedParameters: this._signedParameters,\r\n\t\t\tdata: resultData,\r\n\t\t\tgetParameters: this._getParameters\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconst callback = BX.prop.getFunction(this._callbacks, \"onSuccess\", null);\r\n\r\n\t\t\t\tif (!callback) { return; }\r\n\r\n\t\t\t\tBX.onCustomEvent(\r\n\t\t\t\t\twindow,\r\n\t\t\t\t\t\"BX.UI.EntityEditorAjax:onSubmit\",\r\n\t\t\t\t\t[ response[\"data\"][\"ENTITY_DATA\"], response ]\r\n\t\t\t\t);\r\n\t\t\t\tcallback(response[\"data\"]);\r\n\t\t\t})\r\n\t\t\t.catch((response) => {\r\n\t\t\t\tconst callback = BX.prop.getFunction(this._callbacks, \"onFailure\", null);\r\n\r\n\t\t\t\tif (!callback) { return; }\r\n\r\n\t\t\t\tvar messages = [];\r\n\t\t\t\tvar errors = response[\"errors\"];\r\n\t\t\t\tfor(var i = 0, length = errors.length; i < length; i++) {\r\n\t\t\t\t\tmessages.push(errors[i][\"message\"]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tBX.onCustomEvent(\r\n\t\t\t\t\twindow,\r\n\t\t\t\t\t\"BX.UI.EntityEditorAjax:onSubmitFailure\",\r\n\t\t\t\t\t[ response[\"errors\"] ]\r\n\t\t\t\t);\r\n\r\n\t\t\t\tcallback({ \"ERRORS\": messages });\r\n\t\t\t});\r\n\t}\r\n\r\n}"],"names":["BX","window","Factory","constructor","options","onEditorInit","factory","event","methods","this","name","build","handleEditorInit","type","controlId","settings","prefix","indexOf","internalType","substr","length","map","hasOwnProperty","create","Object","assign","defaults","register","isEditorInitialized","registerEditorMethod","UI","_BX$UI","EntityEditorControlFactory","_BX$UI$EntityEditorCo","initialized","registerFactoryMethod","dir","htmlToElement","html","tag","renderer","document","createElement","innerHTML","firstElementChild","kebabCase","str","split","word","index","toLowerCase","join","copyValues","from","to","fillValues","collectValues","container","inputs","findInputs","result","input","entries","value","values","isChanged","querySelectorAll","replaceTemplateVariables","template","variables","key","replace","Field","EntityEditorField","_hasLayout","getMessage","replaces","messages","super","clearLayout","forget","_wrapper","layout","ensureWrapperCreated","adjustWrapper","isNeedToDisplay","registerLayout","isDragEnabled","appendChild","createDragButton","useTitle","title","getTitle","createTitleNode","render","getValue","isContextMenuEnabled","createContextMenuButton","initializeDragDropAbilities","payload","fewElements","selector","getElementSelector","el","getElement","querySelector","SummarySkeleton","onStatusClick","evt","openDialog","preventDefault","bind","handleStatusClick","setup","element","buildStatus","buildForm","cises","optionValue","status","getStatus","reflowStatus","formValue","setAttribute","textContent","Error","useFormValue","reflowForm","modal","messageBox","Dialogs","MessageBox","setMessage","cloneNode","setButtons","SaveButton","events","click","onSaveClick","CancelButton","onCancelClick","show","popupWindow","contentContainer","onChange","close","STATUS_READY","STATUS_WAIT","STATUS_EMPTY","modalElement","statusElement","inputElement","Cis","onCopyClick","copyInternal","handleCopyClick","copy","updateTotal","count","total","internalCises","buildCopyIcon","parseInt","iterator","Array","fill","dummy","one","util","htmlspecialchars","required","makeInternalValues","trim","push","optionKey","instances","instance","filter","cis","keyWithPrefix","option","copyElement","internalInstances","Digital","buildFormCodes","buildFormAdditional","hasFew","oneValue","ITEM","fieldset","isItemsFilled","filterFilledItems","isSlipFilled","items","item","isArray","slip","rawValues","base","keyRelative","keyChain","valueKeyChain","setValueByKeyChain","parts","part","chain","lastKey","pop","level","nextKey","test","toTree","ItemView","_wires","destroy","forgetWires","extendOptions","basket","columns","keys","COLUMNS","unshift","renderColumn","renderActions","setupWires","mount","point","method","toUpperCase","columnDefault","columnIndex","getName","valueFormatted","columnCis","wire","columnDigital","digital","columnSubsidy","promos","content","promo","columnCount","valueSanitized","parseFloat","callWires","args","apply","formattedKey","field","hasAction","actions","ItemEdit","onCountChange","target","isNaN","onDeleteToggle","isDelete","checked","classList","toggle","disableInput","unbind","handleInputChange","handleDeleteToggle","forEach","ACTION_ITEM","readonly","contains","parentElement","getCountDiff","needDelete","getInputValue","initialCount","getInput","ACTION_CIS","ACTION_DIGITAL","ReferenceField","id","initialize","countChanges","diff","table","renderTable","body","renewItems","ITEMS","basketItem","payloadItems","destroyItems","createItems","itemIndex","payloadItem","createItem","_mode","EntityEditorMode","edit","_editor","showToolPanel","registerActiveControl","_changeHandler","renderHeader","renderSummary","columnTitle","isInEditMode","langKey","lang","SUMMARY","validate","validator","_parent","getChildById","showDialog","Promise","resolve","message","dialogBody","SendButton","onSendClick","reasonControl","productsControl","reasons","changes","change","NAME","COUNT","error","EntityValidationError","addError","toggleUseDimensions","enabled","useDimensions","buildDefined","buildHeader","buildBody","buildSizes","boxDimensions","inputName","inputValue","DIMENSIONS","buildProperties","buildActions","disabled","disabledProperties","boxProperties","property","propertyValue","PROPERTIES","after","updateNumber","number","fulfilmentId","fulfilmentBase","fireChange","onDeleteClick","remove","handleDeleteClick","button","add","fireRemove","dispatchEvent","CustomEvent","detail","bubbles","Collection","onItemRemove","releaseItem","renewNumber","onAddClick","addItem","handleItemRemove","addEventListener","handleAddClick","renderSelf","renderItems","renderAddButton","box","nextIndex","mode","splice","num","last","_this$items","addButton","onTitleActions","context","getParent","useDimensionsNode","renderUseDimensions","definedUseDimensions","customNodes","onUseDimensionsChange","markAsChanged","handleTitleActions","release","handleUseDimensionsChange","node","syncUseDimensions","renderShipments","checkbox","shipmentBoxes","boxCollection","renderShipmentTitle","shipment","insertAdjacentHTML","shipmentCollection","renderShipment","renderShipmentDefined","renderBoxCollection","BoxCollection","onActivityEnd","isMatchActivity","reload","handleActivityEnd","_activityType","broadcast","ACTIVITY_ACTION","_payload$ACTIVITY_ACT","TYPE","activity","buildActivity","makeActivityMethod","action","text","onclick","JSON","stringify","broadcastElement","onDocumentClick","currentTarget","dataset","getItem","url","buildDocumentUrl","createDialog","Show","bindDocumentsClick","link","YandexMarket","PrintDialog","DIALOG_TITLE","TITLE","content_url","width","WIDTH","height","HEIGHT","buttons","btnSave","btnCancel","renderIntro","renderDocuments","notification","Notification","Basket","basket_confirm","BasketConfirm","Shipment","Property","print","Print","editor","data","overrideEditor","overrideEditorAjax","restoreOriginDefault","start","storeOriginDefault","addCustomEvent","_originDefault","_BX","EntityEditor","_BX$UI$EntityEditor","getDefault","setTimeout","setDefault","createAjaxForm","editorValidate","editorCreateAjaxForm","EntityAsyncValidator","control","_activeControls","addResult","_userFieldManager","parentMethod","callbacks","call","overrideAjaxForm","_ajaxForm","ajaxForm","_BX3","_BX3$UI","ComponentAjax","doSubmit","ajaxFormDoSubmit","formData","_elementNode","ajax","prepareForm","clone","_formData","filesCount","isPlainObject","i","resultData","makeFormData","runComponentAction","_className","_actionName","signedParameters","_signedParameters","getParameters","_getParameters","then","response","callback","prop","getFunction","_callbacks","onCustomEvent","catch","errors"],"mappings":"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"}